# dirty toolset

Набор инструментов для работы с API d3.ru.
Для большинства инструментов нужен золотой аккаунт.

[Deno](https://deno.land/), [TypeScript](https://www.typescriptlang.org/).

---

## Переменные окружения
Создайте файл `.env` в корне репозитория и никогда его не добавляйте в коммит.

Содержимое должно выглядеть примерно следующим образом:

```
SID=...
UID=...
CSRF=...
DATA=/Users/mudhoney/Developer/dirty-private
```

Заполните реальными значениями:
`SID`, `UID` и `CSRF` вы найдете в консоли своего браузера.
`DATA` - абсолютный путь к директории, в которой вы хотите хранить данные. Эта директория может быть вне репозитория или в другом репозитории.

## Makefile

Для запуска вы можете использовать `Makefile` или подсмотреть в нем как и что запускать:

* `make integration` - запустить интеграционные тесты.
* `make unit` - запустить юнит-тесты (когда появятся).
* `make username=interesno votes` - сгенерировать JSON-отчеты по голосам в посты, комментарии и карму пользователя interesno. Эта команда создаст следующие файлы в папке `DATA` (см. `.env`):
  * `interesno-delayed-votes.json` - голоса в посты и комментарии пользователя, которые поставлены через три и более суток с момента написания соответствующего поста или комментария.
  * `interesno-votes.json` - все голоса в посты и комментарии пользователя.
  * `interesno-voters.json` - сводка по всем голосующим в посты и комментарии пользователя. Голосующие отсортированы по сумме всех голосов (с учётом веса голоса).
  * `interesno-karma.json` - голоса в карму пользователя.